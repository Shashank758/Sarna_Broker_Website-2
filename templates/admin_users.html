<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>User Access Control | Sarna Broker</title>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
<link rel="stylesheet" href="/static/css/style.css">
</head>

<body>

<!-- ================= TOP NAVBAR ================= -->
<nav class="admin-navbar">
  <div class="nav-left">
    <img src="static/image/Sarna broker.png" alt="Logo">
    <span>Sarna Broker</span>
  </div>

  <center><b>JAI SHREE SHYAM</b></center>

  <div class="nav-right">
    <span class="admin-name">
      <i class="fa fa-user-circle"></i> Admin
    </span>
    <img src="static/image/images.png" alt="Logo">
  </div>
</nav>

<div class="admin-container">

  <!-- SIDEBAR -->
  <aside class="admin-sidebar">
    <h4>Sarna Broker</h4>
    <ul>
      <li><a href="/admin"><i class="fa fa-gauge"></i> Dashboard</a></li>
      <li><a href="/admin/compare"><i class="fa fa-balance-scale"></i> Rate Comparison</a></li>
      <li class="active"><i class="fa fa-users"></i> Users</li>
      <li><a href="/admin/stock"><i class="fa fa-box"></i> Miller Stock</a></li>
      <li><a href="/admin/stock-history"><i class="fa fa-history"></i> Stock Update History</a></li>
      <li><a href="/admin/bookings"><i class="fa fa-shopping-cart"></i> Bookings</a></li>
      <li><a href="/admin/miller-profiles"><i class="fa fa-industry"></i> Miller Profiles</a></li>
      <li><a href="/admin/buyer-profiles"><i class="fa fa-store"></i> Buyer Profiles</a></li>
      <li>
        <i class="fa fa-right-from-bracket"></i>
        <a href="/logout">Logout</a>
      </li>
    </ul>
  </aside>

  <!-- MAIN -->
  <main class="admin-main">

    <div class="admin-top">
      <h5>ðŸ‘¥ User Access Control</h5>
      <span class="admin-badge">Admin</span>
    </div>

<!-- ================= USER ACCESS CONTROL ================= -->
<div class="table-card mt-5">
  <h6>ðŸ‘¥ User Access Control</h6>

  <table class="table table-bordered table-striped table-sm align-middle">
    <tr class="table-secondary">
      <th>Name</th>
      <th>Email</th>
      <th>Role</th>
      <th>Type</th>
      <th>Parent Miller</th>
      <th>Status</th>
      <th>Action</th>
    </tr>

    {% for u in all_users %}
    <tr>
      <td>{{ u[1] }}</td>
<td>{{ u[2] }}</td>
<td>{{ u[3] }}</td>

<!-- STAFF OR MAIN USER -->
<td>
  {% if u[5] == 1 %}
    <span class="badge bg-info">Staff</span>
  {% else %}
    <span class="badge bg-secondary">Main</span>
  {% endif %}
</td>

<!-- PARENT MILLER -->
<td>
  {% if u[5] == 1 %}
    {{ u[6] or 'â€”' }}
  {% else %}
    â€”
  {% endif %}
</td>


      <td>
        {% if u[4] == 'pending' %}
          <span class="badge bg-warning">Pending</span>
        {% elif u[4] == 'approved' %}
          <span class="badge bg-success">Approved</span>
        {% elif u[4] == 'blocked' %}
          <span class="badge bg-danger">Blocked</span>
        {% else %}
          <span class="badge bg-dark">Rejected</span>
        {% endif %}
      </td>

      <td>
        {% if u[4] == 'pending' %}
          <a href="/admin/approve_user/{{ u[0] }}" class="btn btn-sm btn-success">Approve</a>
          <a href="/admin/reject_user/{{ u[0] }}" class="btn btn-sm btn-danger">Reject</a>
        {% elif u[4] == 'approved' %}
          <a href="/admin/block_user/{{ u[0] }}" class="btn btn-sm btn-warning">Block</a>
        {% else %}
          â€”
        {% endif %}
      </td>
    </tr>
    {% endfor %}
  </table>
</div>

  </main>
</div>

</body>
</html>

